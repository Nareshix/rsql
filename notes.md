replace all expect and unwrap with  proper error hadnling